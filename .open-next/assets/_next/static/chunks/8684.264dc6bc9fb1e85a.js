"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8684],{11638:(e,t,l)=>{l.d(t,{A:()=>c});var s=l(95155),a=l(12115),i=l(11906),r=l(31802),n=l(51368),d=l(52643);let o=["image/jpeg","image/png","image/webp","image/gif"],c=e=>{let{onChange:t,value:l,bucket:c="products"}=e,[m,u]=(0,a.useState)(!1),[h,x]=(0,a.useState)(0),[b,p]=(0,a.useState)(null),g=(0,a.useCallback)(async e=>{var l;if(!(null==(l=e.target.files)?void 0:l.length))return;let s=e.target.files[0];if(s){p(null),u(!0),x(0);try{if(!o.includes(s.type))throw Error("Invalid file type ".concat(s.type,". Allowed types: ").concat(o.join(", ")));let e=new Image;await new Promise((t,l)=>{e.onload=t,e.onerror=l,e.src=URL.createObjectURL(s)});let l=Math.min(.9,Math.max(.6,1-s.size/1048576/5)),a={maxSizeMB:5,maxWidthOrHeight:Math.max(e.width,e.height)>1600?1600:void 0,useWebWorker:!0,initialQuality:l,fileType:"image/webp",preserveExif:!0,alwaysKeepResolution:!1,onProgress:e=>{x(.5*e)}},i=await (0,r.A)(s,a),m=null;for(let e=0;e<3;e++)try{x(50+Math.round(e/3*40));let l="".concat((0,n.A)(),".webp"),s="".concat(l),{error:a}=await d.N.storage.from(c).upload(s,i,{contentType:"image/webp",cacheControl:"3600",upsert:!1});if(a)throw a;let{data:{publicUrl:r}}=d.N.storage.from(c).getPublicUrl(s);x(100),t(r);break}catch(t){m=t,t instanceof Error&&t.message,e<2?await new Promise(t=>setTimeout(t,1e3*(e+1))):x(-1)}if(m)throw m}catch(e){p(e instanceof Error?e.message:"Failed to process image"),x(-1)}finally{u(!1)}}},[c,t,d.N]);return(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)("label",{className:"relative cursor-pointer hover:opacity-70 border-dashed border-2 border-neutral-300 flex flex-col justify-center items-center h-[200px] gap-4",children:[(0,s.jsx)("input",{type:"file",onChange:g,accept:o.join(","),className:"hidden",disabled:m}),!l&&!m&&(0,s.jsx)(i.dM0,{size:50}),(0,s.jsx)("div",{className:"font-semibold text-lg text-center",children:m?-1===h?"Upload Failed":"Processing... ".concat(h,"%"):l?"Change Image":"Click to upload"}),b&&!m&&(0,s.jsx)("div",{className:"text-red-500 text-sm absolute bottom-2 left-2 right-2 text-center bg-white/90 py-1 rounded",children:b}),l&&(0,s.jsx)("div",{className:"absolute inset-0 w-full h-full",children:(0,s.jsx)("img",{src:l,alt:"Upload",className:"w-full h-full object-cover"})})]})})}},52643:(e,t,l)=>{l.d(t,{N:()=>i});var s=l(34982);let a=async(e,t)=>{let{timeout:l=3e4}=t||{},s=new AbortController,a=setTimeout(()=>s.abort(),l),i=await fetch(e,{...t,signal:s.signal});return clearTimeout(a),i},i=(0,s.UU)("https://tafojbtftmihrheeyoky.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRhZm9qYnRmdG1paHJoZWV5b2t5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ3Mzk3MTYsImV4cCI6MjA2MDMxNTcxNn0.vdL2odCYREv1GykTt8wx76lmhaHmDkBYcC65L4Z_vXo",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{fetch:a}})},88684:(e,t,l)=>{l.r(t),l.d(t,{default:()=>o});var s=l(95155),a=l(12115),i=l(52643),r=l(11638),n=l(52108),d=l(66766);function o(){var e;let[t,l]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),[m,u]=(0,a.useState)(null),[h,x]=(0,a.useState)({});async function b(){c(!0);let{data:e,error:t}=await i.N.from("hero_slides").select("id, title, subtitle, image_url, link_url, button_text, display_order, active").order("display_order",{ascending:!0});t||l(e||[]),c(!1)}(0,a.useEffect)(()=>{b()},[]);let p=e=>{let l=t.find(t=>t.id===e);l&&(u(e),l&&x({...l}))},g=e=>{let{name:t,value:l,type:s}=e.target;x(a=>({...a,[t]:"checkbox"===s?e.target.checked:l}))};async function f(e){if(m){let{error:t}=await i.N.from("hero_slides").update(e).eq("id",m);t||(u(null),x({}),b())}else{let{error:l}=await i.N.from("hero_slides").insert([{...e,display_order:t.length}]);l||(x({}),b())}}async function j(e){if(!e.destination)return;let s=Array.from(t),[a]=s.splice(e.source.index,1);s.splice(e.destination.index,0,a);let r=s.map((e,t)=>({id:e.id,display_order:t}));for(let e of(l(s),r))await i.N.from("hero_slides").update({display_order:e.display_order}).eq("id",e.id)}return o?(0,s.jsx)("div",{className:"text-center",children:"Loading..."}):(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("button",{onClick:()=>{u(null),x({title:"",subtitle:"",image_url:"",link_url:"#",button_text:"Shop Now",display_order:t.length,active:!0})},className:"bg-green-500 text-white px-4 py-2 rounded mb-4 hover:bg-green-600",children:"Add New Slide"}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm mb-8",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:m?"Edit Slide":"Add New Slide"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),f(h)},children:[(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title"}),(0,s.jsx)("input",{type:"text",name:"title",value:h.title||"",onChange:g,className:"w-full p-2 border rounded",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Subtitle"}),(0,s.jsx)("textarea",{name:"subtitle",value:h.subtitle||"",onChange:g,className:"w-full p-2 border rounded"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Link URL"}),(0,s.jsx)("input",{type:"text",name:"link_url",value:h.link_url||"",onChange:g,className:"w-full p-2 border rounded",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Button Text"}),(0,s.jsx)("input",{type:"text",name:"button_text",value:h.button_text||"",onChange:g,className:"w-full p-2 border rounded",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Image"}),(0,s.jsx)(r.A,{onChange:e=>{x(t=>({...t,image_url:e}))},value:h.image_url,bucket:"hero-slides"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Active"}),(0,s.jsx)("input",{type:"checkbox",name:"active",checked:null==(e=h.active)||e,onChange:g,className:"mb-4"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:m?"Update Slide":"Add Slide"}),m&&(0,s.jsx)("button",{type:"button",onClick:()=>{u(null),x({})},className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",children:"Cancel"})]})]})]}),(0,s.jsx)(n.JY,{onDragEnd:j,enableDefaultSensors:!0,children:(0,s.jsx)(n.gL,{droppableId:"slides",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,mode:"standard",type:"DEFAULT",children:e=>(0,s.jsxs)("ul",{...e.droppableProps,ref:e.innerRef,className:"space-y-4",children:[t.map((e,t)=>(0,s.jsx)(n.sx,{draggableId:String(e.id),index:t,isDragDisabled:!1,disableInteractiveElementBlocking:!1,shouldRespectForcePress:!1,children:t=>(0,s.jsxs)("li",{ref:t.innerRef,...t.draggableProps,...t.dragHandleProps,className:"bg-white rounded-lg shadow-sm p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"relative w-16 h-16",children:(0,s.jsx)(d.default,{src:e.image_url,alt:e.title,fill:!0,className:"object-cover rounded",sizes:"64px"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.subtitle})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(e.active?"bg-green-500":"bg-gray-300")}),(0,s.jsx)("button",{onClick:()=>p(e.id),className:"text-blue-600 hover:text-blue-700",children:"Edit"})]})]})},String(e.id))),e.placeholder]})})})]})}}}]);