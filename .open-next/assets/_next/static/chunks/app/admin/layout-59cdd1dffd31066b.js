(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7581],{9282:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var n=r(95155),o=r(12115),i=r(35695),s=r(73579),a=r(6874),l=r.n(a),c=r(10351),u=r(78260),d=r(52643);let h=o.createContext({newOrderCount:0,resetNewOrderCount:()=>{}}),f=async()=>{try{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),r=e.createGain();t.type="sine",t.frequency.value=1047,r.gain.value=.15,t.connect(r),r.connect(e.destination),t.start(),t.stop(e.currentTime+.18),setTimeout(()=>e.close(),300)}catch(e){try{let e=new Audio("/notification.mp3");e.volume=1,await e.play()}catch(e){}}},m=()=>{if("vibrate"in navigator)try{navigator.vibrate([200,100,200])}catch(e){}};function p(e){let{children:t}=e,r=(0,i.useRouter)(),s=(0,i.usePathname)(),[a,l]=(0,o.useState)(0),c=()=>l(0);return(0,o.useEffect)(()=>{let e=()=>c();return window.addEventListener("resetOrderCount",e),(null==s?void 0:s.startsWith("/admin/orders"))&&c(),()=>{window.removeEventListener("resetOrderCount",e)}},[s,c]),(0,o.useEffect)(()=>{let e,t=async()=>{try{let{data:{session:e},error:t}=await d.N.auth.getSession();if(t||!(null==e?void 0:e.user))return!1;let{data:r,error:n}=await d.N.rpc("is_admin");if(n)return!1;return!!r}catch(e){return!1}},o=0,i=!1,s=async()=>{try{if(!await t())return;e=d.N.channel("new_orders").on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},async e=>{let t=e.new;if(!window.location.pathname.startsWith("/admin/orders")){l(e=>e+1),f().catch(console.error),m();let e="order-".concat(t.id);u.oR.success((0,n.jsxs)("div",{className:"cursor-pointer",onClick:()=>{r.push("/admin/orders/".concat(t.id)),u.oR.dismiss(e)},children:["\uD83D\uDED2 New Order #",t.id," received!"]}),{id:e,duration:1e4,position:"top-right",style:{background:"#4CAF50",color:"#fff",cursor:"pointer",zIndex:1e4,width:"auto",minWidth:"300px"}})}}).subscribe(e=>{"CHANNEL_ERROR"===e||"TIMED_OUT"===e?o<5?(o++,setTimeout(s,2e3)):u.oR.error((0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:"Live order notifications are offline. "}),(0,n.jsx)("button",{className:"ml-2 underline text-blue-200 hover:text-white",onClick:()=>{o=0,i=!0,s(),u.oR.dismiss()},children:"Retry"})]}),{duration:1e4,position:"top-right"}):"SUBSCRIBED"===e&&(o=0,i&&(u.oR.success("Live order notifications reconnected!",{duration:4e3,position:"top-right"}),i=!1))})}catch(e){o<5?(o++,setTimeout(s,2e3)):u.oR.error((0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:"Live order notifications failed to connect. "}),(0,n.jsx)("button",{className:"ml-2 underline text-blue-200 hover:text-white",onClick:()=>{o=0,i=!0,s(),u.oR.dismiss()},children:"Retry"})]}),{duration:1e4,position:"top-right"})}};return s(),()=>{e&&d.N.removeChannel(e).then(()=>console.log("Subscription removed")).catch(e=>console.error("Error removing subscription:",e))}},[]),(0,o.useEffect)(()=>{window.location.pathname.startsWith("/admin/orders")&&l(0)},[s]),(0,n.jsx)(h.Provider,{value:{newOrderCount:a,resetNewOrderCount:c},children:t})}function v(){let e=(0,i.useRouter)(),t=(0,s.createClientComponentClient)(),r=async()=>{await t.auth.signOut(),localStorage.clear(),sessionStorage.clear(),e.replace("/login")};return(0,n.jsx)("button",{onClick:r,style:{padding:8,borderRadius:4,background:"#e53e3e",color:"white",border:"none"},children:"Sign Out"})}let x=[{name:"Dashboard",href:"/admin",icon:c.V5Y},{name:"Products",href:"/admin/products",icon:c.est},{name:"Featured Products",href:"/admin/featured",icon:c.usP},{name:"Trending Products",href:"/admin/trending",icon:c.ARf},{name:"Best Deals",href:"/admin/deals",icon:c.fTJ},{name:"Orders",href:"/admin/orders",icon:c.iHs,showBadge:!0},{name:"Blog Posts",href:"/admin/blog",icon:c.jH2},{name:"Categories",href:"/admin/categories",icon:c.QPV},{name:"Hero Slides",href:"/admin/hero-slides",icon:c.fZZ},{name:"Analytics",href:"/admin/analytics",icon:c.vQY},{name:"Settings",href:"/admin/settings",icon:c.VSk}];function b(e){let{onNavigate:t}=e,r=(0,i.usePathname)();(0,i.useRouter)(),(0,s.createClientComponentClient)();let{newOrderCount:a}=(0,o.useContext)(h),c=e=>r===e;return(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-y-auto bg-white",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center border-b border-gray-200 py-4 gap-2",children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Admin Panel"}),(0,n.jsx)(v,{})]}),(0,n.jsx)("nav",{className:"flex-1 space-y-1 px-2 py-4",children:x.map(e=>{let r=e.showBadge&&a>0;return(0,n.jsxs)(l(),{href:e.href,className:"group relative flex items-center rounded-md px-2 py-2 text-sm font-medium ".concat(c(e.href)?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),onClick:()=>{if(t&&t(),r){let e=new CustomEvent("resetOrderCount");window.dispatchEvent(e)}},children:[(0,n.jsx)(e.icon,{className:"mr-3 h-6 w-6 flex-shrink-0 ".concat(c(e.href)?"text-gray-500":"text-gray-400 group-hover:text-gray-500"),"aria-hidden":"true"}),e.name,r&&(0,n.jsx)("span",{className:"ml-auto inline-flex items-center justify-center rounded-full bg-red-500 px-2 py-0.5 text-xs font-medium text-white",children:a})]},e.name)})})]})}var g=r(52767);function y(e){let{children:t}=e;(0,i.useRouter)(),(0,s.createClientComponentClient)();let[r,a]=o.useState(!1),l=()=>a(!1);return(0,n.jsx)(g.default,{initialSession:null,children:(0,n.jsxs)(p,{children:[(0,n.jsxs)("div",{className:"flex min-h-screen bg-gray-100",children:[(0,n.jsx)("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50 transition-opacity lg:hidden ".concat(r?"opacity-100":"pointer-events-none opacity-0"),onClick:l}),(0,n.jsx)("div",{className:"fixed inset-y-0 left-0 z-50 w-64 transform bg-white shadow-lg transition-transform duration-300 ease-in-out lg:relative lg:translate-x-0 ".concat(r?"translate-x-0":"-translate-x-full"),children:(0,n.jsx)(b,{onNavigate:l})}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[(0,n.jsxs)("header",{className:"flex h-16 items-center justify-between border-b border-gray-200 bg-white px-4 shadow-sm lg:hidden",children:[(0,n.jsxs)("button",{type:"button",className:"rounded-md p-2 text-gray-500 hover:bg-gray-100 hover:text-gray-600",onClick:()=>a(!r),children:[(0,n.jsx)("span",{className:"sr-only",children:"Open sidebar"}),(0,n.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),(0,n.jsx)("h1",{className:"text-lg font-medium text-gray-900",children:"Admin Panel"})]}),(0,n.jsx)("main",{className:"flex-1 overflow-y-auto p-4 lg:p-6",children:t})]})]}),(0,n.jsx)(u.l$,{position:"top-right",toastOptions:{style:{borderRadius:"10px",background:"#333",color:"#fff"}}})]})})}},12270:(e,t,r)=>{"use strict";var n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(e,t,r)=>new Promise((n,o)=>{var i=e=>{try{a(r.next(e))}catch(e){o(e)}},s=e=>{try{a(r.throw(e))}catch(e){o(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,s);a((r=r.apply(e,t)).next())}),l={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(l,{SessionContextProvider:()=>h,useSession:()=>p,useSessionContext:()=>f,useSupabaseClient:()=>m,useUser:()=>v}),e.exports=((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of i(t))s.call(e,l)||l===r||n(e,l,{get:()=>t[l],enumerable:!(a=o(t,l))||a.enumerable});return e})(n({},"__esModule",{value:!0}),l);var c=r(12115),u=r(95155),d=(0,c.createContext)({isLoading:!0,session:null,error:null,supabaseClient:{}}),h=({supabaseClient:e,initialSession:t=null,children:r})=>{let[n,o]=(0,c.useState)(t),[i,s]=(0,c.useState)(!t),[l,h]=(0,c.useState)();(0,c.useEffect)(()=>{!n&&t&&o(t)},[n,t]),(0,c.useEffect)(()=>{let t=!0;return!function(){a(this,null,function*(){let{data:{session:r},error:n}=yield e.auth.getSession();if(t){if(n){h(n),s(!1);return}o(r),s(!1)}})}(),()=>{t=!1}},[]),(0,c.useEffect)(()=>{let{data:{subscription:t}}=e.auth.onAuthStateChange((e,t)=>{t&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e)&&o(t),"SIGNED_OUT"===e&&o(null)});return()=>{t.unsubscribe()}},[]);let f=(0,c.useMemo)(()=>i?{isLoading:!0,session:null,error:null,supabaseClient:e}:l?{isLoading:!1,session:null,error:l,supabaseClient:e}:{isLoading:!1,session:n,error:null,supabaseClient:e},[i,n,l]);return(0,u.jsx)(d.Provider,{value:f,children:r})},f=()=>{let e=(0,c.useContext)(d);if(void 0===e)throw Error("useSessionContext must be used within a SessionContextProvider.");return e};function m(){let e=(0,c.useContext)(d);if(void 0===e)throw Error("useSupabaseClient must be used within a SessionContextProvider.");return e.supabaseClient}var p=()=>{let e=(0,c.useContext)(d);if(void 0===e)throw Error("useSession must be used within a SessionContextProvider.");return e.session},v=()=>{var e,t;let r=(0,c.useContext)(d);if(void 0===r)throw Error("useUser must be used within a SessionContextProvider.");return null!=(t=null==(e=r.session)?void 0:e.user)?t:null}},30689:(e,t,r)=>{Promise.resolve().then(r.bind(r,9282))},35695:(e,t,r)=>{"use strict";r.r(t);var n=r(18999),o={};for(let e in n)"default"!==e&&(o[e]=()=>n[e]);r.d(t,o)},52643:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var n=r(34982);let o=async(e,t)=>{let{timeout:r=3e4}=t||{},n=new AbortController,o=setTimeout(()=>n.abort(),r),i=await fetch(e,{...t,signal:n.signal});return clearTimeout(o),i},i=(0,n.UU)("https://tafojbtftmihrheeyoky.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRhZm9qYnRmdG1paHJoZWV5b2t5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ3Mzk3MTYsImV4cCI6MjA2MDMxNTcxNn0.vdL2odCYREv1GykTt8wx76lmhaHmDkBYcC65L4Z_vXo",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{fetch:o}})},52767:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var n=r(95155),o=r(12270),i=r(73579);function s(e){let{children:t,initialSession:r}=e,s=(0,i.createClientComponentClient)();return(0,n.jsx)(o.SessionContextProvider,{supabaseClient:s,initialSession:r,children:t})}},74436:(e,t,r)=>{"use strict";r.d(t,{k5:()=>u});var n=r(12115),o={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i=n.createContext&&n.createContext(o),s=["attr","size","title"];function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e){return t=>n.createElement(d,a({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>n.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function d(e){var t=t=>{var r,{attr:o,size:i,title:l}=e,u=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,s),d=i||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),n.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,u,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),l&&n.createElement("title",null,l),e.children)};return void 0!==i?n.createElement(i.Consumer,null,e=>t(e)):t(o)}}},e=>{var t=t=>e(e.s=t);e.O(0,[844,4982,6874,3579,8260,8441,1684,7358],()=>t(30689)),_N_E=e.O()}]);